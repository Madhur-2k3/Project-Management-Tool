<apex:page controller="ProjectReportPDFController" 
         renderAs="pdf" 
         showHeader="false" 
         sidebar="false"
         standardStylesheets="false"
         applyBodyTag="false"
         applyHtmlTag="false">
    
    <html>
        <head>
            <style type="text/css">
                /* PDF Styles */
                @page {
                    size: A4;
                    margin: 1cm;
                }
                
                body {
                    font-family: Arial, Helvetica, sans-serif;
                    font-size: 12px;
                    color: #333;
                    line-height: 1.5;
                }
                
                /* Header Styles */
                .report-header {
                    text-align: center;
                    border-bottom: 3px solid #0070d2;
                    padding-bottom: 15px;
                    margin-bottom: 20px;
                }
                
                .report-title {
                    font-size: 24px;
                    font-weight: bold;
                    color: #0070d2;
                    margin: 0;
                }
                
                .report-subtitle {
                    font-size: 14px;
                    color: #666;
                    margin-top: 5px;
                }
                
                .generated-date {
                    font-size: 10px;
                    color: #888;
                    margin-top: 10px;
                }
                
                /* Section Styles */
                .section {
                    margin-bottom: 25px;
                    page-break-inside: avoid;
                }
                
                .section-title {
                    font-size: 16px;
                    font-weight: bold;
                    color: #0070d2;
                    border-bottom: 2px solid #0070d2;
                    padding-bottom: 5px;
                    margin-bottom: 15px;
                }
                
                /* Project Details Styles */
                .project-info {
                    background-color: #f4f6f9;
                    padding: 15px;
                    border-radius: 5px;
                }
                
                .info-row {
                    display: block;
                    margin-bottom: 10px;
                }
                
                .info-label {
                    font-weight: bold;
                    color: #555;
                    display: inline-block;
                    width: 150px;
                }
                
                .info-value {
                    color: #333;
                }
                
                /* Statistics Cards */
                .stats-container {
                    width: 100%;
                    margin-bottom: 20px;
                }
                
                .stats-table {
                    width: 100%;
                    border-collapse: collapse;
                }
                
                .stat-card {
                    text-align: center;
                    padding: 15px;
                    background-color: #f4f6f9;
                    border: 1px solid #ddd;
                }
                
                .stat-value {
                    font-size: 28px;
                    font-weight: bold;
                    color: #0070d2;
                }
                
                .stat-label {
                    font-size: 11px;
                    color: #666;
                    text-transform: uppercase;
                }
                
                /* Table Styles */
                .data-table {
                    width: 100%;
                    border-collapse: collapse;
                    margin-top: 10px;
                }
                
                .data-table th {
                    background-color: #0070d2;
                    color: white;
                    padding: 10px 8px;
                    text-align: left;
                    font-size: 11px;
                    text-transform: uppercase;
                }
                
                .data-table td {
                    padding: 10px 8px;
                    border-bottom: 1px solid #ddd;
                    font-size: 11px;
                }
                
                .data-table tr:nth-child(even) {
                    background-color: #f9f9f9;
                }
                
                /* Priority Badges */
                .priority-high {
                    color: #c23934;
                    font-weight: bold;
                }
                
                .priority-medium {
                    color: #ff9800;
                    font-weight: bold;
                }
                
                .priority-low {
                    color: #4caf50;
                    font-weight: bold;
                }
                
                /* Status Badges */
                .status-completed {
                    color: #4caf50;
                    font-weight: bold;
                }
                
                .status-in-progress {
                    color: #0070d2;
                    font-weight: bold;
                }
                
                .status-not-started {
                    color: #888;
                    font-weight: bold;
                }
                
                /* Footer */
                .report-footer {
                    text-align: center;
                    font-size: 10px;
                    color: #888;
                    border-top: 1px solid #ddd;
                    padding-top: 15px;
                    margin-top: 30px;
                }
                
                /* No data message */
                .no-data {
                    text-align: center;
                    color: #888;
                    font-style: italic;
                    padding: 20px;
                }
            </style>
        </head>
        
        <body>
            <!-- Report Header -->
            <div class="report-header">
                <h1 class="report-title">Project Report</h1>
                <p class="report-subtitle">{!project.Project_Name__c}</p>
                <p class="generated-date">Generated on: {!generatedDateFormatted}</p>
            </div>
            
            <!-- Project Details Section -->
            <div class="section">
                <h2 class="section-title">Project Details</h2>
                <div class="project-info">
                    <div class="info-row">
                        <span class="info-label">Project Name:</span>
                        <span class="info-value">{!project.Project_Name__c}</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Status:</span>
                        <span class="info-value">{!project.Status__c}</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Start Date:</span>
                        <span class="info-value">
                            <apex:outputText value="{0, date, MMMM d, yyyy}">
                                <apex:param value="{!project.Start_Date__c}"/>
                            </apex:outputText>
                        </span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">End Date:</span>
                        <span class="info-value">
                            <apex:outputText value="{0, date, MMMM d, yyyy}">
                                <apex:param value="{!project.End_Date__c}"/>
                            </apex:outputText>
                        </span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Milestone:</span>
                        <span class="info-value">{!project.Milestone__c}</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Description:</span>
                        <span class="info-value">{!project.Description__c}</span>
                    </div>
                </div>
            </div>
            
            <!-- Task Statistics Section -->
            <div class="section">
                <h2 class="section-title">Task Statistics</h2>
                <div class="stats-container">
                    <table class="stats-table">
                        <tr>
                            <td class="stat-card">
                                <div class="stat-value">{!totalTasks}</div>
                                <div class="stat-label">Total Tasks</div>
                            </td>
                            <td class="stat-card">
                                <div class="stat-value">{!completedTasks}</div>
                                <div class="stat-label">Completed</div>
                            </td>
                            <td class="stat-card">
                                <div class="stat-value">{!inProgressTasks}</div>
                                <div class="stat-label">In Progress</div>
                            </td>
                            <td class="stat-card">
                                <div class="stat-value">{!notStartedTasks}</div>
                                <div class="stat-label">Not Started</div>
                            </td>
                            <td class="stat-card">
                                <div class="stat-value">{!totalTeamMembers}</div>
                                <div class="stat-label">Team Members</div>
                            </td>
                        </tr>
                    </table>
                </div>
            </div>
            
            <!-- Tasks Section -->
            <div class="section">
                <h2 class="section-title">Tasks ({!totalTasks})</h2>
                <apex:outputPanel rendered="{!tasks.size > 0}">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th style="width: 25%;">Task Name</th>
                                <th style="width: 20%;">Assigned To</th>
                                <th style="width: 12%;">Priority</th>
                                <th style="width: 13%;">Status</th>
                                <th style="width: 12%;">Due Date</th>
                                <th style="width: 18%;">Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <apex:repeat value="{!tasks}" var="task">
                                <tr>
                                    <td>{!task.Name}</td>
                                    <td>{!task.Assigned_to__r.Name}</td>
                                    <td>
                                        <apex:outputPanel styleClass="priority-high" rendered="{!task.Priority__c == 'High'}">
                                            {!task.Priority__c}
                                        </apex:outputPanel>
                                        <apex:outputPanel styleClass="priority-medium" rendered="{!task.Priority__c == 'Medium'}">
                                            {!task.Priority__c}
                                        </apex:outputPanel>
                                        <apex:outputPanel styleClass="priority-low" rendered="{!task.Priority__c == 'Low'}">
                                            {!task.Priority__c}
                                        </apex:outputPanel>
                                    </td>
                                    <td>
                                        <apex:outputPanel styleClass="status-completed" rendered="{!task.Status__c == 'Completed'}">
                                            {!task.Status__c}
                                        </apex:outputPanel>
                                        <apex:outputPanel styleClass="status-in-progress" rendered="{!task.Status__c == 'In Progress'}">
                                            {!task.Status__c}
                                        </apex:outputPanel>
                                        <apex:outputPanel styleClass="status-not-started" rendered="{!task.Status__c == 'Not Started'}">
                                            {!task.Status__c}
                                        </apex:outputPanel>
                                    </td>
                                    <td>
                                        <apex:outputText value="{0, date, MMM d, yyyy}">
                                            <apex:param value="{!task.Due_Date__c}"/>
                                        </apex:outputText>
                                    </td>
                                    <td>{!task.Description__c}</td>
                                </tr>
                            </apex:repeat>
                        </tbody>
                    </table>
                </apex:outputPanel>
                <apex:outputPanel rendered="{!tasks.size == 0}">
                    <p class="no-data">No tasks found for this project.</p>
                </apex:outputPanel>
            </div>
            
            <!-- Team Members Section -->
            <div class="section">
                <h2 class="section-title">Team Members ({!totalTeamMembers})</h2>
                <apex:outputPanel rendered="{!teamMembers.size > 0}">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th style="width: 35%;">Name</th>
                                <th style="width: 30%;">Role</th>
                                <th style="width: 35%;">Email</th>
                            </tr>
                        </thead>
                        <tbody>
                            <apex:repeat value="{!teamMembers}" var="member">
                                <tr>
                                    <td>{!member.Employee__r.Name}</td>
                                    <td>{!member.Employee__r.Role__c}</td>
                                    <td>{!member.Employee__r.Email__c}</td>
                                </tr>
                            </apex:repeat>
                        </tbody>
                    </table>
                </apex:outputPanel>
                <apex:outputPanel rendered="{!teamMembers.size == 0}">
                    <p class="no-data">No team members assigned to this project.</p>
                </apex:outputPanel>
            </div>
            
            
        </body>
    </html>
</apex:page>

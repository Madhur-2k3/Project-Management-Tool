<template>
    <section class=" ">
        <div class="container">
            <header class="header">
                <h2 class="slds-text-heading_medium">{projectName}</h2>
            </header>
            <div class=" slds-p-around_medium">
                <div class="header">
                    <div class="stats-cards">
                        <div class="card">
                            <div class="left">
                                <p class="card-title">Total Tasks</p>
                                <p class="card-value">{totalTasks}</p>
                            </div>
                            <div class="right">
                                <lightning-icon icon-name="standard:task" size="large"></lightning-icon>
                            </div>

                        </div>
                        <div class="card">
                            <div class="left">
                                <p class="card-title">Completed Tasks</p>
                                <p class="card-value">{completedTasks}</p>
                                <p class="card-btm">of {totalTasks} total</p>
                            </div>
                            <div class="right">
                                <lightning-icon icon-name="standard:task" size="large"></lightning-icon>
                            </div>

                        </div>
                        <div class="card">
                            <div class="left">
                                <p class="card-title">In Progress Tasks</p>
                                <p class="card-value">{inProgressTasks}</p>
                            </div>
                            <div class="right">
                                <lightning-icon icon-name="standard:task" size="large"></lightning-icon>
                            </div>

                        </div>
                        <div class="card">
                            <div class="left">
                                <p class="card-title">Team Members</p>
                                <p class="card-value">{totalTeamMembers}</p>
                            </div>
                            <div class="right">
                                <lightning-icon icon-name="standard:task" size="large"></lightning-icon>
                            </div>

                        </div>
                    </div>
                    <div class="btn">
                        <lightning-button label="Create Task" onclick={handleCreateTask}
                            variant="brand"></lightning-button>
                        <lightning-button label="Manage Members" onclick={handleManageMembers}
                            variant="brand"></lightning-button>
                    </div>
                    <template if:true={showManageMembersModal}>
                        <section role="dialog" tabindex="-1" aria-modal="true" aria-labelledby="modal-heading-01"
                            class="slds-modal slds-fade-in-open modal">
                            <div class="slds-modal__container">
                                <header class="slds-modal__header">
                                    <h2 id="modal-heading-01" class="slds-text-heading_medium">Manage Members</h2>
                                </header>
                                <div class="slds-modal__content slds-p-around_medium">
                                    <div class="project-members">
                                        <h2>Project Members</h2>
                                        <lightning-datatable key-field="Id" data={teamMembers} columns={teamMemberColumns}
                                        hide-checkbox-column="true"></lightning-datatable>
                                    </div>
                                    <div class="available-members">
                                        <h2>Available Members</h2>
                                        <lightning-datatable key-field="Id" data={availableMembers} columns={availableMemberColumns}
                                        hide-checkbox-column="true"></lightning-datatable>
                                    </div>
                                    
                                </div>
                                <footer class="slds-modal__footer">
                                    <lightning-button variant="neutral" label="Cancel"
                                        onclick={handleCancel}></lightning-button>
                                    <!-- <lightning-button variant="brand" label="Save" onclick={handleSave}></lightning-button> -->
                                </footer>
                            </div>
                        </section>
                    </template>
                </div>
                <div class="hero-section">
                    <div class="search-n-filter">
                        <div class="search">
                            <lightning-input type="search" label="Search" placeholder="Search by Task name"
                                onchange={handleSearchChange}></lightning-input>

                        </div>
                        <div class="filter">
                            <lightning-combobox name="status-filter" value={selectedStatus} label="Status"
                                options={statusOptions} onchange={handleStatusChange}></lightning-combobox>
                        </div>
                        <div class="filter">
                            <lightning-combobox name="priority-filter" value={selectedPriority} label="Priority"
                                options={priorityOptions} onchange={handlePriorityChange}></lightning-combobox>
                        </div>
                    </div>
                    <div class="hero-main">
                        <div class="kanban-container">
                            <template for:each={statusWithTasks} for:item="col">
                                <div key={col.status}
                                    class="kanban-column"
                                    data-status={col.status}    
                                    ondragover={handleDragOver}
                                    ondrop={handleDrop}
                                >
                                <h2 class="column-title">{col.status}</h2>
                                <template for:each={col.tasks} for:item="task">
                                    <div key={task.Id} class={task.cardClass}
                                        draggable="true"
                                        data-id={task.Id}
                                        ondragstart={handleDragStart}
                                        >
                                        <h3 class="task-title">{task.Name}</h3>
                                        <p class="task-priority">Priority: {task.Priority__c}</p>
                                        <p class="task-due-date">Due Date: {task.Due_Date__c}</p>
                                    </div>
                                </template>
                            </div>
                            </template>
                        </div>
                    </div>
                    <!-- <lightning-datatable key-field="Id" data={taskData} columns={taskColumns}
                        hide-checkbox-column="true"></lightning-datatable> -->
                </div>
            </div>

        </div>

    </section>
</template>